# --- QUERIES ---

query GetUser($uid: String!) {
  user(id: $uid) {
    id
    username  # Fixed: matches schema
    email
  }
}

query ListGameNights {
  gameNights {
    id
    name
    eventDate
    eventTime
    isFinalized
    creator {
      username
    }
  }
}

query GetInvitations($gameNightId: UUID!) {
  gameNightInvitations(where: { gameNight: { id: { eq: $gameNightId } } }) {
    id
    status
    user {    # Fixed: matches schema (was invitee)
      username
      email
    }
  }
}

# --- MUTATIONS ---

mutation CreateUser($uid: String!, $username: String!, $email: String) {
  user_insert(data: {
    id: $uid, 
    username: $username, 
    email: $email
  })
}

# Fixed: Requires ID input because we removed the broken uuidV4 generator
mutation CreateGameNight($id: UUID!, $name: String!, $date: Date!, $creatorId: String!) {
  gameNight_insert(data: {
    id: $id,
    name: $name,
    eventDate: $date,
    creatorId: $creatorId,
    isFinalized: false
  })
}

mutation SuggestGame($id: UUID!, $title: String!, $userId: String!) {
  gameSuggestion_insert(data: {
    id: $id,
    title: $title,
    suggestedById: $userId,
    votes: 1
  })
}

# Fixed: Removed "foodItem" and "type" fields that didn't exist
mutation ProposeGameForNight($gameNightId: UUID!, $suggestionId: UUID!) {
  gameNightProposal_insert(data: {
    gameNightId: $gameNightId,
    suggestionId: $suggestionId
  })
}

mutation InviteUser($id: UUID!, $gameNightId: UUID!, $userId: String!) {
  gameNightInvitation_insert(data: {
    id: $id,
    gameNightId: $gameNightId,
    userId: $userId, # Fixed: matches schema (was inviteeId)
    status: "Pending"
  })
}